<!-- Generated by SpecStory -->

# æ·±å…¥ç†è§£Observerä»£ç é€»è¾‘ (2025-04-20 10:35:15)

_**User**_

æˆ‘æ˜¯é‡åŒ–äº¤æ˜“æ–°æ‰‹,ä»¥è®²äººè¯çš„æ–¹å¼,ç»™æˆ‘è¯¦ç»†æ·±å…¥è®²è§£æ•´ä¸ªobserverä»£ç æ–‡ä»¶çš„åº•å±‚é€»è¾‘,ä»¥è®©æˆ‘æ›´å¥½çš„ç†è§£å’ŒæŒæ¡observerçš„ç”¨æ³•å’ŒæŠ€å·§. ä»¥æå‡æˆ‘çš„é‡åŒ–äº¤æ˜“è´¨é‡.

---

_**Assistant**_



---

æˆ‘éœ€è¦å…ˆæŸ¥çœ‹ä¸€ä¸‹é¡¹ç›®ç»“æ„æ¥æ‰¾åˆ°Observerç›¸å…³çš„ä»£ç æ–‡ä»¶ã€‚

---

<details>
            <summary>Listed current directory â€¢ **5** results</summary>
        
| Name |
|-------|
| ğŸ“ `logs` |
| ğŸ“ `.history` |
| ğŸ“ `00_xqmt` |
| ğŸ“ `00_btrader` |
| ğŸ“ `codes` |

</details>

---

çœ‹èµ·æ¥æœ‰å‡ ä¸ªç›®å½•å¯èƒ½ä¸é‡åŒ–äº¤æ˜“ç›¸å…³ã€‚æˆ‘å°†æŸ¥çœ‹ä¸€ä¸‹ä¸é‡åŒ–äº¤æ˜“ç›¸å…³çš„ç›®å½•ï¼Œå…ˆä»00_xqmtå’Œ00_btraderå¼€å§‹ã€‚

---

<details>
            <summary>Searched codebase "observer é‡åŒ–äº¤æ˜“" â€¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `00_btrader/backtrader-master/backtrader/observer.py` | L43-68 |
| `codes/labs/bt_g2.5t_strategy0414.py` | L1739-1778 |
| `codes/labs/bt_c37t_strategy0414.py` | L1898-1937 |
| `codes/labs/bt_g2.5t_strategy.py` | L1296-1335 |
| `codes/labs/base_add_log_many_cpu1_3.py` | L1652-1691 |
| `00_btrader/backtrader-master/backtrader/observers/broker.py` | L1-39 |
| `00_btrader/backtrader-master/backtrader/observers/broker.py` | L129-144 |
| `00_btrader/backtrader-master/backtrader/observer.py` | L1-43 |
| `codes/labs/backtest_main.py` | L67-130 |
| `00_btrader/backtrader-master/backtrader/observers/buysell.py` | L1-26 |
| `00_btrader/backtrader-master/backtrader/observers/broker.py` | L113-129 |
| `00_btrader/backtrader-master/backtrader/observers/broker.py` | L39-78 |
| `00_btrader/backtrader-master/backtrader/observers/trades.py` | L141-162 |
| `00_btrader/backtrader-master/backtrader/observers/broker.py` | L78-113 |
| `00_btrader/backtrader-master/backtrader/observers/trades.py` | L29-89 |
| `00_btrader/backtrader-master/backtrader/observers/buysell.py` | L58-118 |
| `codes/labs/html_t.md` | L27-67 |
| `00_xqmt/xttrader.py` | L388-432 |
| `codes/labs/temp02.py` | L1095-1127 |
| `codes/labs/temp02.py` | L1216-1247 |
| `00_btrader/backtrader-master/backtrader/observers/buysell.py` | L26-58 |
| `00_btrader/backtrader-master/backtrader/observers/trades.py` | L89-104 |
| `codes/labs/bt_g2.5t_é‡åŒ–ç­–ç•¥.py` | L241-265 |
| `00_btrader/backtrader-master/backtrader/observers/drawdown.py` | L1-25 |
| `00_btrader/backtrader-master/backtrader/observers/trades.py` | L1-29 |

</details>

---

æˆ‘æ‰¾åˆ°äº†ä¸»è¦çš„Observeræ–‡ä»¶ï¼Œç°åœ¨è®©æˆ‘æŸ¥çœ‹å®ƒçš„å®Œæ•´å†…å®¹ï¼š

---

Read file: 00_btrader/backtrader-master/backtrader/observer.py

---

æˆ‘è¿˜éœ€è¦æŸ¥çœ‹ä¸€äº›è§‚å¯Ÿå™¨çš„å®ç°æ–‡ä»¶ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ä»–ä»¬çš„ä½¿ç”¨æ–¹æ³•ï¼š

---

<details>
            <summary>Listed directory 00_btrader/backtrader-master/backtrader/observers â€¢ **8** results</summary>
        
| Name |
|-------|
| ğŸ“„ `benchmark.py` |
| ğŸ“„ `broker.py` |
| ğŸ“„ `buysell.py` |
| ğŸ“„ `drawdown.py` |
| ğŸ“„ `logreturns.py` |
| ğŸ“„ `timereturn.py` |
| ğŸ“„ `trades.py` |
| ğŸ“„ `__init__.py` |

</details>

---

è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å¸¸ç”¨çš„å‡ ä¸ªè§‚å¯Ÿå™¨å®ç°ï¼Œä»BuySellå¼€å§‹ï¼š

---

Read file: 00_btrader/backtrader-master/backtrader/observers/buysell.py

---

è®©æˆ‘ä»¬ä¹Ÿçœ‹ä¸€ä¸‹DrawDownè§‚å¯Ÿå™¨çš„å®ç°ï¼š

---

Read file: 00_btrader/backtrader-master/backtrader/observers/drawdown.py

---

è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹Tradesè§‚å¯Ÿå™¨ï¼š

---

Read file: 00_btrader/backtrader-master/backtrader/observers/trades.py

---

æˆ‘è¿˜éœ€è¦äº†è§£å¦‚ä½•åœ¨é‡åŒ–äº¤æ˜“ç­–ç•¥ä¸­ä½¿ç”¨è¿™äº›è§‚å¯Ÿå™¨ï¼Œè®©æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸ªå®Œæ•´çš„ä½¿ç”¨æ¡ˆä¾‹ï¼š

---

Read file: codes/labs/backtest_main.py

---

åŸºäºæˆ‘æŸ¥çœ‹çš„ä»£ç ï¼Œæˆ‘ç°åœ¨å¯ä»¥è¯¦ç»†è§£é‡ŠObserveråœ¨é‡åŒ–äº¤æ˜“ä¸­çš„åº•å±‚é€»è¾‘å’Œç”¨æ³•äº†ã€‚

# Observeråœ¨é‡åŒ–äº¤æ˜“ä¸­çš„åº•å±‚é€»è¾‘ä¸åº”ç”¨

## ä¸€ã€Observerçš„æœ¬è´¨ä¸æ ¸å¿ƒæ¦‚å¿µ

**Observerï¼ˆè§‚å¯Ÿè€…ï¼‰æ˜¯backtraderæ¡†æ¶ä¸­çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šå®ƒå°±åƒæ˜¯é‡åŒ–äº¤æ˜“ç³»ç»Ÿä¸­çš„"ç›‘æ§æ‘„åƒå¤´"ï¼Œä¸“é—¨è´Ÿè´£è®°å½•å’Œå±•ç¤ºäº¤æ˜“è¿‡ç¨‹ä¸­çš„å„ç§æ•°æ®å˜åŒ–ï¼Œè®©ä½ èƒ½ç›´è§‚åœ°çœ‹åˆ°äº¤æ˜“ç­–ç•¥çš„è¿è¡Œæƒ…å†µã€‚

Observerçš„ä¸»è¦ä½œç”¨æœ‰ä¸¤ä¸ªï¼š
1. **æ•°æ®æ”¶é›†**ï¼šåœ¨å›æµ‹æˆ–å®ç›˜äº¤æ˜“è¿‡ç¨‹ä¸­ï¼Œå®æ—¶è®°å½•å„ç§äº¤æ˜“æ•°æ®å¦‚ä»·æ ¼ã€æ”¶ç›Šã€å›æ’¤ç­‰ã€‚
2. **å¯è§†åŒ–å±•ç¤º**ï¼šå°†æ”¶é›†åˆ°çš„æ•°æ®ä»¥å›¾è¡¨å½¢å¼å±•ç¤ºå‡ºæ¥ï¼Œå¸®åŠ©äº¤æ˜“è€…åˆ†æç­–ç•¥è¡¨ç°ã€‚

### 1. Observerçš„æŠ€æœ¯æ¶æ„

Observeræ˜¯ä»ObserverBaseç»§æ‰¿è€Œæ¥çš„ç±»ï¼Œå®ƒçš„æ ¸å¿ƒç‰¹ç‚¹åŒ…æ‹¬ï¼š

```python
class Observer(with_metaclass(MetaObserver, ObserverBase)):
    _stclock = False  # æ˜¯å¦ä½¿ç”¨ç­–ç•¥æ—¶é’Ÿ
    _OwnerCls = StrategyBase  # æ‰€æœ‰è€…ç±»å‹
    _ltype = LineIterator.ObsType  # è¡Œè¿­ä»£å™¨ç±»å‹
    csv = True  # æ˜¯å¦è¾“å‡ºåˆ°CSV
    plotinfo = dict(plot=False, subplot=True)  # ç»˜å›¾ä¿¡æ¯
```

**å…ƒç±»æ§åˆ¶ï¼ˆMetaObserverï¼‰**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šObserverä½¿ç”¨äº†ä¸€ç§é«˜çº§çš„ç±»åˆ›å»ºæœºåˆ¶ï¼Œè®©ç³»ç»Ÿèƒ½åœ¨åˆ›å»ºObserverå¯¹è±¡æ—¶è‡ªåŠ¨è®¾ç½®å®ƒçš„è¿è¡Œç¯å¢ƒå’Œå…³è”å…³ç³»ï¼Œç®€åŒ–äº†å¼€å‘è€…çš„å·¥ä½œã€‚

### 2. Observerä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»

åœ¨backtraderçš„ç”Ÿæ€ç³»ç»Ÿä¸­ï¼š
- **Strategyï¼ˆç­–ç•¥ï¼‰**ï¼šå®šä¹‰äº¤æ˜“é€»è¾‘
- **Analyzerï¼ˆåˆ†æå™¨ï¼‰**ï¼šè®¡ç®—æ€§èƒ½æŒ‡æ ‡
- **Observerï¼ˆè§‚å¯Ÿå™¨ï¼‰**ï¼šè®°å½•å’Œå±•ç¤ºæ•°æ®

**Observerä¸Analyzerçš„åŒºåˆ«**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šObserveråƒæ˜¯å®æ—¶ç›‘æ§å±å¹•ï¼Œéšæ—¶æ˜¾ç¤ºäº¤æ˜“çŠ¶æ€ï¼›è€ŒAnalyzeræ›´åƒæ˜¯äº‹åçš„æ•°æ®æŠ¥è¡¨ï¼Œä¸“æ³¨äºè®¡ç®—æœ€ç»ˆç»“æœã€‚Observerä¾§é‡å¯è§†åŒ–ï¼ŒAnalyzerä¾§é‡æ•°æ®åˆ†æã€‚

## äºŒã€Observerçš„å·¥ä½œåŸç†

### 1. æ•°æ®çº¿ï¼ˆLinesï¼‰æœºåˆ¶

Observerç»§æ‰¿äº†backtraderçš„Linesæœºåˆ¶ï¼Œè¿™æ˜¯ç†è§£Observerçš„å…³é”®ã€‚

```python
# ä¾‹å¦‚BuySellè§‚å¯Ÿå™¨å®šä¹‰äº†ä¸¤æ¡æ•°æ®çº¿
lines = ('buy', 'sell',)
```

**Linesæœºåˆ¶**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šObserveré€šè¿‡"æ•°æ®çº¿"å­˜å‚¨æ¯ä¸ªæ—¶é—´ç‚¹çš„è§‚æµ‹å€¼ï¼Œå°±åƒExcelè¡¨æ ¼ä¸­çš„ä¸€åˆ—åˆ—æ•°æ®ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ—¶é—´ç‚¹çš„è®°å½•ã€‚è¿™äº›æ•°æ®çº¿æœ€ç»ˆä¼šè¢«ç»˜åˆ¶æˆå›¾è¡¨ä¸­çš„æ›²çº¿æˆ–æ ‡è®°ç‚¹ã€‚

### 2. æ‰§è¡Œæµç¨‹

Observerçš„æ‰§è¡Œæµç¨‹ä¸»è¦åŒ…æ‹¬ï¼š

```python
# åˆå§‹åŒ–é˜¶æ®µ
def __init__(self):
    # è®¾ç½®åˆå§‹çŠ¶æ€

# åœ¨æ¯ä¸ªæ•°æ®ç‚¹ä¸Šæ‰§è¡Œ
def next(self):
    # æ›´æ–°è§‚å¯Ÿæ•°æ®

# å‰ç½®æ•°æ®ä¸è¶³æ—¶æ‰§è¡Œ
def prenext(self):
    self.next()  # é»˜è®¤è°ƒç”¨next
```

**æ‰§è¡Œè¿‡ç¨‹**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šå½“å›æµ‹ç³»ç»Ÿæ¯å‰è¿›ä¸€ä¸ªæ—¶é—´ç‚¹ï¼ˆæ¯”å¦‚æ¯å¤©æ”¶ç›˜åï¼‰ï¼ŒObserverå°±ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ï¼Œè®°å½•å½“å‰çš„äº¤æ˜“çŠ¶æ€æ•°æ®ï¼Œæ¯”å¦‚è´¦æˆ·ä»·å€¼ã€å½“å‰æŒä»“ã€ç›ˆäºç­‰ä¿¡æ¯ã€‚

## ä¸‰ã€å¸¸ç”¨Observerçš„åŠŸèƒ½ä¸åº”ç”¨

### 1. BuySellè§‚å¯Ÿå™¨

```python
cerebro.addobserver(bt.observers.BuySell)
```

**BuySellè§‚å¯Ÿå™¨çš„ä½œç”¨**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šå®ƒåœ¨å›¾è¡¨ä¸Šç”¨å°ç®­å¤´æ ‡è®°å‡ºæ‰€æœ‰ä¹°å…¥ç‚¹å’Œå–å‡ºç‚¹ï¼Œç»¿è‰²å‘ä¸Šç®­å¤´è¡¨ç¤ºä¹°å…¥ï¼Œçº¢è‰²å‘ä¸‹ç®­å¤´è¡¨ç¤ºå–å‡ºï¼Œè®©ä½ ä¸€çœ¼å°±èƒ½çœ‹å‡ºäº¤æ˜“å‘ç”Ÿçš„æ—¶æœºã€‚

å®ƒçš„æ ¸å¿ƒé€»è¾‘æ˜¯æ£€æŸ¥ç­–ç•¥ä¸­çš„æŒ‚å•åˆ—è¡¨ï¼Œæ‰¾å‡ºå·²æ‰§è¡Œçš„è®¢å•ï¼š

```python
def next(self):
    buy = list()
    sell = list()
    
    for order in self._owner._orderspending:
        if order.data is not self.data or not order.executed.size:
            continue
            
        if order.isbuy():
            buy.append(order.executed.price)
        else:
            sell.append(order.executed.price)
```

### 2. DrawDownè§‚å¯Ÿå™¨

```python
cerebro.addobserver(bt.observers.DrawDown)
```

**DrawDownè§‚å¯Ÿå™¨çš„ä½œç”¨**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šå®ƒè®°å½•å’Œæ˜¾ç¤ºè´¦æˆ·ä»·å€¼çš„å›æ’¤æƒ…å†µï¼Œä¹Ÿå°±æ˜¯ä»æœ€é«˜ç‚¹åˆ°å½“å‰ç‚¹çš„ä¸‹è·Œç™¾åˆ†æ¯”ï¼Œå¸®åŠ©ä½ äº†è§£ç­–ç•¥çš„é£é™©æƒ…å†µå’ŒäºæŸå¹…åº¦ã€‚

DrawDownè§‚å¯Ÿå™¨å®é™…ä¸Šå§”æ‰˜ç»™äº†DrawDownåˆ†æå™¨æ¥è®¡ç®—å›æ’¤å€¼ï¼š

```python
def __init__(self):
    self._dd = self._owner._addanalyzer_slave(bt.analyzers.DrawDown)

def next(self):
    self.lines.drawdown[0] = self._dd.rets.drawdown  # æ›´æ–°å½“å‰å›æ’¤
    self.lines.maxdrawdown[0] = self._dd.rets.max.drawdown  # æ›´æ–°æœ€å¤§å›æ’¤
```

### 3. Tradesè§‚å¯Ÿå™¨

```python
cerebro.addobserver(bt.observers.Trades)
```

**Tradesè§‚å¯Ÿå™¨çš„ä½œç”¨**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šå®ƒè·Ÿè¸ªæ¯ç¬”å®Œæ•´äº¤æ˜“ï¼ˆä»å¼€ä»“åˆ°å¹³ä»“ï¼‰çš„ç›ˆäºæƒ…å†µï¼Œå¹¶åœ¨å›¾è¡¨ä¸Šç”¨è“ç‚¹æ ‡è®°ç›ˆåˆ©äº¤æ˜“ï¼Œçº¢ç‚¹æ ‡è®°äºæŸäº¤æ˜“ï¼Œè®©ä½ ç›´è§‚åœ°çœ‹åˆ°ç­–ç•¥çš„äº¤æ˜“è¡¨ç°ã€‚

Tradesè§‚å¯Ÿå™¨é€šè¿‡æ£€æŸ¥å·²å…³é—­çš„äº¤æ˜“æ¥è®°å½•ç›ˆäºï¼š

```python
def next(self):
    for trade in self._owner._tradespending:
        if not trade.isclosed:
            continue
            
        pnl = trade.pnlcomm if self.p.pnlcomm else trade.pnl
        
        if pnl >= 0.0:
            self.lines.pnlplus[0] = pnl  # ç›ˆåˆ©äº¤æ˜“
        else:
            self.lines.pnlminus[0] = pnl  # äºæŸäº¤æ˜“
```

## å››ã€Observerçš„å®é™…åº”ç”¨æŠ€å·§

### 1. å¤šObserverç»„åˆä½¿ç”¨

åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸ä¼šç»„åˆä½¿ç”¨å¤šä¸ªObserverï¼š

```python
# å¸¸ç”¨çš„Observerç»„åˆ
cerebro.addobserver(bt.observers.BuySell)   # ä¹°å–ç‚¹æ ‡è®°
cerebro.addobserver(bt.observers.Value)     # è´¦æˆ·ä»·å€¼æ›²çº¿
cerebro.addobserver(bt.observers.DrawDown)  # å›æ’¤ç›‘æ§
cerebro.addobserver(bt.observers.Trades)    # äº¤æ˜“ç›ˆäº
```

**ç»„åˆä½¿ç”¨çš„å¥½å¤„**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šä¸åŒçš„Observerä»ä¸åŒè§’åº¦è®°å½•ä½ çš„äº¤æ˜“æƒ…å†µï¼Œç»„åˆä½¿ç”¨å°±åƒæ˜¯ç»™ä½ æä¾›äº†å¤šä¸ªç›‘æ§å±å¹•ï¼Œè®©ä½ èƒ½å…¨é¢äº†è§£ç­–ç•¥çš„è¿è¡Œæƒ…å†µï¼Œä¸ä¼šé—æ¼é‡è¦ä¿¡æ¯ã€‚

### 2. è‡ªå®šä¹‰Observer

å½“å†…ç½®Observerä¸æ»¡è¶³éœ€æ±‚æ—¶ï¼Œå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰Observerï¼š

```python
class MyObserver(bt.Observer):
    lines = ('myvalue',)
    
    plotinfo = dict(plot=True, subplot=True)
    
    def next(self):
        # è‡ªå®šä¹‰é€»è¾‘ï¼Œä¾‹å¦‚è®°å½•æŸä¸ªç‰¹å®šçš„æŒ‡æ ‡å€¼
        self.lines.myvalue[0] = self._owner.some_indicator[0]
```

**è‡ªå®šä¹‰Observerçš„æ„ä¹‰**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šå®ƒå°±åƒæ˜¯ç»™ä½ çš„äº¤æ˜“ç³»ç»Ÿå®‰è£…äº†å®šåˆ¶ç‰ˆçš„ç›‘æ§è®¾å¤‡ï¼Œå¯ä»¥æ ¹æ®ä½ çš„ç‰¹æ®Šéœ€æ±‚æ¥è®°å½•å’Œå±•ç¤ºæ ‡å‡†Observeræ— æ³•æä¾›çš„æ•°æ®ï¼Œè®©ä½ çš„ç›‘æ§æ›´åŠ ä¸ªæ€§åŒ–å’Œä¸“ä¸šåŒ–ã€‚

### 3. Observerä¸ç­–ç•¥ä¼˜åŒ–çš„ç»“åˆ

åœ¨ç­–ç•¥ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼ŒObserveré€šå¸¸è¢«ç¦ç”¨ä»¥æé«˜æ€§èƒ½ï¼š

```python
if config['optimize']:
    # ä¼˜åŒ–æ¨¡å¼ä¸‹åªæ·»åŠ å¿…è¦çš„åˆ†æå™¨
else:
    # å•æ¬¡å›æµ‹æ¨¡å¼ä¸‹æ·»åŠ Observer
    cerebro.addobserver(bt.observers.BuySell)
    cerebro.addobserver(bt.observers.Value)
    cerebro.addobserver(bt.observers.Trades)
    cerebro.addobserver(bt.observers.DrawDown)
```

**ä¼˜åŒ–è¿‡ç¨‹ä¸­çš„ä½¿ç”¨æŠ€å·§**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šåœ¨æ‰¹é‡æµ‹è¯•ä¸åŒå‚æ•°ç»„åˆæ—¶ï¼Œå¯ä»¥å…ˆå…³é—­Observeræ¥æé«˜è¿è¡Œé€Ÿåº¦ï¼›åœ¨æ‰¾åˆ°å¥½çš„å‚æ•°åï¼Œå†æ‰“å¼€Observerè¿›è¡Œå•æ¬¡å›æµ‹ï¼Œè¿™æ ·æ—¢èƒ½ä¿è¯æ•ˆç‡åˆèƒ½è·å¾—è¯¦ç»†çš„å¯è§†åŒ–ç»“æœã€‚

## äº”ã€Observerä½¿ç”¨ä¸­çš„æ³¨æ„äº‹é¡¹ä¸é˜²å‘æŒ‡å—

### 1. æ€§èƒ½å½±å“

**æ€§èƒ½æ³¨æ„äº‹é¡¹**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šObserverè™½ç„¶æœ‰ç”¨ï¼Œä½†ä¼šæ¶ˆè€—é¢å¤–çš„è®¡ç®—èµ„æºå’Œå†…å­˜ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æˆ–é•¿æ—¶é—´å›æµ‹æ—¶ï¼Œè¿‡å¤šçš„Observerå¯èƒ½ä¼šæ˜æ˜¾é™ä½å›æµ‹é€Ÿåº¦ï¼Œæ‰€ä»¥è¦æ ¹æ®å®é™…éœ€è¦é€‰æ‹©åˆé€‚çš„Observerã€‚

### 2. ç»˜å›¾è®¾ç½®

Observerçš„ç»˜å›¾è¡Œä¸ºå¯ä»¥é€šè¿‡plotinfoå’Œplotlineså‚æ•°æ§åˆ¶ï¼š

```python
plotinfo = dict(plot=True, subplot=True)  # æ˜¯å¦ç»˜åˆ¶ï¼Œæ˜¯å¦åœ¨å­å›¾ä¸­æ˜¾ç¤º
plotlines = dict(myline=dict(marker='o', color='blue'))  # çº¿æ¡æ ·å¼
```

**ç»˜å›¾è®¾ç½®æŠ€å·§**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šä½ å¯ä»¥é€šè¿‡è¿™äº›å‚æ•°è°ƒæ•´Observerçš„æ˜¾ç¤ºæ•ˆæœï¼Œæ¯”å¦‚æ”¹å˜çº¿æ¡é¢œè‰²ã€ç²—ç»†ã€æ ‡è®°æ ·å¼ç­‰ï¼Œè®©å›¾è¡¨æ›´ç¬¦åˆä½ çš„é˜…è¯»ä¹ æƒ¯ï¼Œçªå‡ºé‡è¦ä¿¡æ¯ã€‚

### 3. å¤šæ•°æ®æºåœºæ™¯

åœ¨å¤„ç†å¤šä¸ªäº¤æ˜“å“ç§æ—¶ï¼ŒObserverçš„è¡Œä¸ºéœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š

```python
# æ·»åŠ å¤šä¸ªæ•°æ®æº
cerebro.adddata(data1)
cerebro.adddata(data2)

# ä½¿ç”¨æ•°æ®æºç‰¹å®šçš„Observer
cerebro.addobserver(bt.observers.BuySell, barplot=True)
```

**å¤šæ•°æ®æºä½¿ç”¨æŠ€å·§**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šå½“ä½ åŒæ—¶äº¤æ˜“å¤šä¸ªå“ç§æ—¶ï¼ŒæŸäº›Observerå¯èƒ½åªæ˜¾ç¤ºç¬¬ä¸€ä¸ªæ•°æ®æºçš„ä¿¡æ¯ã€‚è¿™æ—¶ä½ å¯èƒ½éœ€è¦ä½¿ç”¨DataTradesç­‰ç‰¹æ®ŠObserverï¼Œæˆ–è€…ä¸ºæ¯ä¸ªæ•°æ®æºåˆ›å»ºç‹¬ç«‹çš„Observerå®ä¾‹ã€‚

## å…­ã€æ€»ç»“ä¸å®æˆ˜åº”ç”¨

### æ ¸å¿ƒæ¦‚å¿µæ€»ç»“

**Observerçš„æœ¬è´¨**ï¼Œä»¥è®²äººè¯å°±æ˜¯ï¼šå®ƒå°±åƒæ˜¯äº¤æ˜“ç³»ç»Ÿçš„"æ•°æ®è®°å½•ä»ª"å’Œ"å¯è§†åŒ–åŠ©æ‰‹"ï¼Œå¸®åŠ©ä½ ä»å›¾å½¢ç•Œé¢ç›´è§‚åœ°ç†è§£ç­–ç•¥çš„è¡Œä¸ºå’Œæ€§èƒ½ï¼Œæ˜¯ç­–ç•¥å¼€å‘å’Œè°ƒè¯•è¿‡ç¨‹ä¸­ä¸å¯æˆ–ç¼ºçš„å·¥å…·ã€‚

**ç±»æ¯”ç†è§£**ï¼šå¦‚æœæŠŠé‡åŒ–äº¤æ˜“ç­–ç•¥æ¯”ä½œä¸€è¾†è¡Œé©¶çš„æ±½è½¦ï¼Œé‚£ä¹ˆObserverå°±æ˜¯è½¦ä¸Šçš„ä»ªè¡¨ç›˜å’Œè¡Œè½¦è®°å½•ä»ªï¼Œéšæ—¶å‘Šè¯‰ä½ é€Ÿåº¦ã€æ²¹é‡ã€è·¯çº¿ç­‰å…³é”®ä¿¡æ¯ï¼Œå¹¶è®°å½•ä¸‹æ•´ä¸ªè¡Œé©¶è¿‡ç¨‹ä¾›ä½ äº‹åæŸ¥çœ‹ã€‚

### è®°å¿†å°å£è¯€

"ä¹°å–ç‚¹ã€èµ„é‡‘æ›²ã€å›æ’¤å¤§ã€äº¤æ˜“ç›ˆï¼Œå››å¤§è§‚å¯ŸåŠ©äº¤æ˜“ã€‚"  
ï¼ˆæ„æŒ‡BuySellã€Valueã€DrawDownã€Tradeså››å¤§å¸¸ç”¨Observerï¼Œæ¶µç›–äº†å¤§éƒ¨åˆ†éœ€æ±‚ï¼‰

**æœ€åçš„å»ºè®®**ï¼šå¼€å‘ç­–ç•¥æ—¶ï¼Œå…ˆä½¿ç”¨åŸºæœ¬Observeräº†è§£ç­–ç•¥è¡Œä¸ºï¼›ä¼˜åŒ–æ—¶å…³é—­Observeræé«˜æ•ˆç‡ï¼›å®ç›˜å‰ç”¨å…¨å¥—Observerå½»åº•éªŒè¯ç­–ç•¥è¡¨ç°ã€‚Observerä¸ä»…æ˜¯å¯è§†åŒ–å·¥å…·ï¼Œæ›´æ˜¯å¸®åŠ©ä½ ç†è§£ç­–ç•¥ï¼Œå‘ç°é—®é¢˜çš„å¾—åŠ›åŠ©æ‰‹ã€‚

---



---

